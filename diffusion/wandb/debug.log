2024-05-10 02:08:32,577 INFO    MainThread:2814831 [wandb_setup.py:_flush():76] Current SDK version is 0.16.6
2024-05-10 02:08:32,577 INFO    MainThread:2814831 [wandb_setup.py:_flush():76] Configure stats pid to 2814831
2024-05-10 02:08:32,577 INFO    MainThread:2814831 [wandb_setup.py:_flush():76] Loading settings from /users/lyu49/.config/wandb/settings
2024-05-10 02:08:32,577 INFO    MainThread:2814831 [wandb_setup.py:_flush():76] Loading settings from /oscar/home/lyu49/csci2470/diffusion/wandb/settings
2024-05-10 02:08:32,577 INFO    MainThread:2814831 [wandb_setup.py:_flush():76] Loading settings from environment variables: {'mode': 'offline'}
2024-05-10 02:08:32,577 INFO    MainThread:2814831 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2024-05-10 02:08:32,577 INFO    MainThread:2814831 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'train.py', 'program_abspath': '/oscar/home/lyu49/csci2470/diffusion/train.py', 'program': '/oscar/home/lyu49/csci2470/diffusion/train.py'}
2024-05-10 02:08:32,577 INFO    MainThread:2814831 [wandb_init.py:_log_setup():521] Logging user logs to /oscar/home/lyu49/csci2470/diffusion/wandb/offline-run-20240510_020832-xy4fn430/logs/debug.log
2024-05-10 02:08:32,577 INFO    MainThread:2814831 [wandb_init.py:_log_setup():522] Logging internal logs to /oscar/home/lyu49/csci2470/diffusion/wandb/offline-run-20240510_020832-xy4fn430/logs/debug-internal.log
2024-05-10 02:08:32,577 INFO    MainThread:2814831 [wandb_init.py:init():561] calling init triggers
2024-05-10 02:08:32,577 INFO    MainThread:2814831 [wandb_init.py:init():568] wandb.init called with sweep_config: {}
config: {}
2024-05-10 02:08:32,577 INFO    MainThread:2814831 [wandb_init.py:init():611] starting backend
2024-05-10 02:08:32,578 INFO    MainThread:2814831 [wandb_init.py:init():615] setting up manager
2024-05-10 02:08:32,578 INFO    MainThread:2814831 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-05-10 02:08:32,584 INFO    MainThread:2814831 [wandb_init.py:init():623] backend started and connected
2024-05-10 02:08:32,586 INFO    MainThread:2814831 [wandb_init.py:init():715] updated telemetry
2024-05-10 02:08:32,587 INFO    MainThread:2814831 [wandb_init.py:init():748] communicating run to backend with 90.0 second timeout
2024-05-10 02:08:32,590 INFO    MainThread:2814831 [wandb_init.py:init():799] starting run threads in backend
2024-05-10 02:08:33,207 INFO    MainThread:2814831 [wandb_run.py:_console_start():2335] atexit reg
2024-05-10 02:08:33,208 INFO    MainThread:2814831 [wandb_run.py:_redirect():2190] redirect: wrap_raw
2024-05-10 02:08:33,208 INFO    MainThread:2814831 [wandb_run.py:_redirect():2255] Wrapping output streams.
2024-05-10 02:08:33,208 INFO    MainThread:2814831 [wandb_run.py:_redirect():2280] Redirects installed.
2024-05-10 02:08:33,208 INFO    MainThread:2814831 [wandb_init.py:init():842] run started, returning control to user process
2024-05-10 02:08:33,209 INFO    MainThread:2814831 [wandb_run.py:_config_callback():1347] config_cb None None {'lr': 0.001, 'batch_size': 2048, 'microbatch': 64, 'learning_steps': 15000, 'log_interval': 500, 'save_interval': 500, 'eval_interval': 500, 'ema_rate': '0.9999', 'resume_checkpoint': 'none', 'schedule_sampler': 'lossaware', 'diffusion_steps': 2000, 'noise_schedule': 'sqrt', 'timestep_respacing': '', 'vocab': 'gpt2', 'use_plm_init': 'gpt2', 'vocab_size': 25370, 'config_name': 'uer/gpt2-chinese-ancient', 'notes': 'train-24history20240510-02:07:02', 'data_dir': './data', 'dataset': '24history', 'checkpoint_path': 'diffusion_models/diffuseq_24history_h768_lr0.001_t2000_sqrt_lossaware_seed102_train-24history20240510-02:07:02', 'seq_len': 128, 'hidden_t_dim': 768, 'hidden_dim': 768, 'dropout': 0.1, 'use_fp16': False, 'fp16_scale_growth': 0.001, 'seed': 102, 'gradient_clipping': -1.0, 'weight_decay': 0.0, 'learn_sigma': False, 'use_kl': False, 'predict_xstart': True, 'rescale_timesteps': True, 'rescale_learned_sigmas': False, 'sigma_small': False, 'emb_scale_factor': 1.0}
